model:
  audio:
    backbone: HTSAT
    ckpt_path:
    - ckpts/EINV2-HTSAT-0.514.ckpt
    - ckpts/CLAP/630k-audioset-fusion-best.pt
    output_dim: 768
    kwargs:
      spec_size: 256
      patch_size: 4
      patch_stride:
      - 4
      - 4
      embed_dim: 96
      depths:
      - 2
      - 2
      - 6
      - 2
      num_heads:
      - 4
      - 8
      - 16
      - 32
      window_size: 8
      mlp_ratio: 4
      qkv_bias: true
      drop_rate: 0.0
      attn_drop_rate: 0.0
      drop_path_rate: 0.1
      ape: false
      patch_norm: true
      norm_before_mlp: ln
    seld_method: EINV2
  text:
    backbone: roberta
    ckpt_path: ckpts/CLAP/630k-audioset-fusion-best.pt
  mlp_loss: false
  loss_weights:
  - 1.0
  - 1.0
  fusion:
    enable: true
    type: aff_2d
  batch_size: 64
  optimizer:
    method: Adam
    kwargs:
      lr: 0.0001
      betas:
      - 0.9
      - 0.999
      eps: 1.0e-08
      momentum: null
  lr_scheduler:
    method: cosinelr
    warmup_epochs: 3
  n_events: 2
model/params/total: 0
model/params/trainable: 0
model/params/non_trainable: 0
data:
  truncation: fusion
  data_filling: repeatpad
  sample_rate: 24000
  nfft: 1024
  n_mels: 64
  hoplen: 240
  window: hann
  chunklen_sec: 10
  train_dataset:
    sClotho:
    - train
    - valid
    sAudioCaps:
    - train
    - valid
  valid_dataset:
    sClotho:
    - test
    sAudioCaps:
    - test
  test_dataset:
    sClotho:
    - test
trainer:
  _target_: lightning.pytorch.trainer.Trainer
  default_root_dir: ${paths.output_dir}
  min_epochs: 1
  max_epochs: 10
  accelerator: gpu
  devices: 1
  precision: 32
  check_val_every_n_epoch: 1
  num_sanity_val_steps: 0
  deterministic: false
  gradient_clip_val: 1.0
callbacks:
  model_checkpoint:
    _target_: lightning.pytorch.callbacks.ModelCheckpoint
    dirpath: ${paths.output_dir}/checkpoints
    filename: epoch_{epoch:03d}
    monitor: train/total_loss
    verbose: false
    save_last: true
    save_top_k: 1
    mode: min
    auto_insert_metric_name: false
    save_weights_only: false
    every_n_train_steps: null
    train_time_interval: null
    every_n_epochs: null
    save_on_train_epoch_end: null
  early_stopping:
    monitor: train/total_loss
    patience: 100
    mode: min
  model_summary:
    max_depth: -1
extras:
  ignore_warnings: false
  print_config: true
task_name: ${task}_test
tags: null
ckpt_path: /gpfs/work/int/peiweiren25/Temporal_SALM/T-SALM_v4/logs/spatial-retrieval/runs/2026-01-26_06-57-29/checkpoints/epoch_009.ckpt
seed: 2025
